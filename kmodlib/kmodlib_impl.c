/*-----------------------------------------------------------------------------
 * Kmodlib.prx v0.1 created by Jackson Mo
 *---------------------------------------------------------------------------*/

#include <pspsdk.h> 
#include <pspkernel.h>
#include "kmodlib.h"


/*-----------------------------------------------------------------------------
 * Module info
 *---------------------------------------------------------------------------*/
PSP_MODULE_INFO( "kmodlib", PSP_MODULE_KERNEL, 0, 1 );
PSP_MAIN_THREAD_ATTR( 0 );


/*-----------------------------------------------------------------------------
 * Type definitions
 *---------------------------------------------------------------------------*/
//#define printf    pspDebugScreenPrintf


/*-----------------------------------------------------------------------------
 * Prototypes
 *---------------------------------------------------------------------------*/
int module_start(SceSize args_, void * argp_);
int module_stop();
int kmodExec(KmodexecFunc func_, void * arg_);
int kmodIsIntrContext();


/*-----------------------------------------------------------------------------
 * Implementations
 *---------------------------------------------------------------------------*/
int module_start(SceSize args_, void * argp_)
{
  /* Do nothing here */
  return 0;
}
/*---------------------------------------------------------------------------*/
int module_stop()
{
  /* Do nothing here */
  return 0;
}
/*---------------------------------------------------------------------------*/
int kmodExec(KmodexecFunc func_, void * arg_)
{
  unsigned int k1;
  int rt;

  if ( func_ != NULL )
  {
    k1 = pspSdkSetK1( 0 );
    rt = func_( arg_ );
    (void)pspSdkSetK1( k1 );
  }

  return rt;
}
/*---------------------------------------------------------------------------*/
int kmodIsIntrContext()
{
  return sceKernelIsIntrContext();
}


/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
